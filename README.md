# WireGuard Relay Server

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](LICENSE)
[![Bash](https://img.shields.io/badge/Bash-4.0%2B-green.svg)](https://www.gnu.org/software/bash/)

–ü—Ä–æ—Å—Ç–æ–π –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ relay-—Å–µ—Ä–≤–µ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç WireGuard —Ç—Ä–∞—Ñ–∏–∫ –∫ —Ü–µ–ª–µ–≤–æ–º—É —Å–µ—Ä–≤–µ—Ä—É. –û—Å–æ–±–µ–Ω–Ω–æ –ø–æ–ª–µ–∑–µ–Ω, –∫–æ–≥–¥–∞ –∏–∑ –≤–∞—à–µ–π —Å–µ—Ç–∏ –Ω–µ—Ç –ø—Ä—è–º–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ WireGuard —Å–µ—Ä–≤–µ—Ä—É.

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø–æ–∑–≤–æ–ª—è–µ—Ç –±—ã—Å—Ç—Ä–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–µ—Ä–≤–µ—Ä –¥–ª—è —Ñ–æ—Ä–≤–∞—Ä–¥–∏–Ω–≥–∞ –∏ NAT –ø–∞–∫–µ—Ç–æ–≤ –≤ —Å—Ç–æ—Ä–æ–Ω—É –ª—é–±–æ–≥–æ WireGuard —Å–µ—Ä–≤–µ—Ä–∞. –í –∫–∞—á–µ—Å—Ç–≤–µ –ø—Ä–∏–º–µ—Ä–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è CloudFlare WARP, –Ω–æ –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Ä–µ–ª–µ–π –¥–ª—è –ª—é–±–æ–≥–æ WireGuard-—Å–æ–≤–º–µ—Å—Ç–∏–º–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞.

### –°—Ö–µ–º–∞ —Ä–∞–±–æ—Ç—ã

```
[–ö–ª–∏–µ–Ω—Ç] ‚îÄ‚îÄUDP‚îÄ‚îÄ> [Relay Server] ‚îÄ‚îÄUDP‚îÄ‚îÄ> [CloudFlare WARP/WireGuard Server]
                    (–≤–∞—à —Å–µ—Ä–≤–µ—Ä)         (engage.cloudflareclient.com:4500)
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Linux —Å–µ—Ä–≤–µ—Ä —Å root –¥–æ—Å—Ç—É–ø–æ–º
- –ü—É–±–ª–∏—á–Ω—ã–π IP –∞–¥—Ä–µ—Å
- –û—Ç–∫—Ä—ã—Ç—ã–π UDP –ø–æ—Ä—Ç (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 4500)
- curl, iptables, sysctl

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
```bash
git clone https://github.com/bekirovtimur/warp-relay.git
cd warp-relay
```

2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç:
```bash
sudo ./relay.sh
```

3. –ì–æ—Ç–æ–≤–æ! –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ IP –≤–∞—à–µ–≥–æ relay-—Å–µ—Ä–≤–µ—Ä–∞ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ WireGuard –∫–ª–∏–µ–Ω—Ç–∞.

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|------------|----------|----------------------|
| `TARGET_HOST` | –¶–µ–ª–µ–≤–æ–π —Ö–æ—Å—Ç –¥–ª—è —Ä–µ–ª–µ—è | `engage.cloudflareclient.com` |
| `TARGET_PORT` | –¶–µ–ª–µ–≤–æ–π –ø–æ—Ä—Ç | `4500` |
| `SKIP_SAVE` | –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ iptables | `no` |

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

**–†–µ–ª–µ–π –¥–ª—è CloudFlare WARP (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é):**
```bash
sudo ./relay.sh
```

**–†–µ–ª–µ–π –¥–ª—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ WireGuard —Å–µ—Ä–≤–µ—Ä–∞:**
```bash
sudo TARGET_HOST=your.wg.server.com TARGET_PORT=51820 ./relay.sh
```

**–ë–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è iptables –ø—Ä–∞–≤–∏–ª:**
```bash
sudo SKIP_SAVE=yes ./relay.sh
```

## üîß –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

–°–∫—Ä–∏–ø—Ç –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è:

1. **–í–∫–ª—é—á–∞–µ—Ç IP forwarding** - –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–µ—Ä–≤–µ—Ä—É –ø–µ—Ä–µ—Å—ã–ª–∞—Ç—å –ø–∞–∫–µ—Ç—ã –º–µ–∂–¥—É –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞–º–∏
2. **–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç NAT (DNAT)** - –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –≤—Ö–æ–¥—è—â–∏–µ UDP –ø–∞–∫–µ—Ç—ã –Ω–∞ —Ü–µ–ª–µ–≤–æ–π —Å–µ—Ä–≤–µ—Ä
3. **–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç MASQUERADE** - –º–∞—Å–∫–∏—Ä—É–µ—Ç –∏—Å—Ö–æ–¥—è—â–∏–µ –ø–∞–∫–µ—Ç—ã
4. **–†–∞–∑—Ä–µ—à–∞–µ—Ç —Ñ–æ—Ä–≤–∞—Ä–¥–∏–Ω–≥** - –¥–æ–±–∞–≤–ª—è–µ—Ç –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –ø–∞–∫–µ—Ç–æ–≤
5. **–°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø—Ä–∞–≤–∏–ª–∞** - —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç iptables-persistent –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
warp-relay/
‚îú‚îÄ‚îÄ relay.sh          # –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
‚îú‚îÄ‚îÄ README.md         # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îú‚îÄ‚îÄ LICENSE           # –õ–∏—Ü–µ–Ω–∑–∏—è MIT
‚îú‚îÄ‚îÄ .gitignore        # –ò—Å–∫–ª—é—á–µ–Ω–∏—è git
‚îî‚îÄ‚îÄ examples/
    ‚îî‚îÄ‚îÄ cloudflare-warp.conf  # –ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ WARP
```

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –°–∫—Ä–∏–ø—Ç —Ç—Ä–µ–±—É–µ—Ç root –ø—Ä–∞–≤ —Ç–æ–ª—å–∫–æ –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- –í—Å–µ iptables –ø—Ä–∞–≤–∏–ª–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º –ø–æ—Ä—Ç–æ–º –∏ –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–º
- –ò—Å—Ö–æ–¥—è—â–∏–π —Ç—Ä–∞—Ñ–∏–∫ –º–∞—Å–∫–∏—Ä—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è —É—Ç–µ—á–∫–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —Å–µ—Ç–∏

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –ø—Ä–∞–≤–∏–ª

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä NAT –ø—Ä–∞–≤–∏–ª
sudo iptables -t nat -L PREROUTING -n --line-numbers

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ø—Ä–∞–≤–∏–ª —Ñ–æ—Ä–≤–∞—Ä–¥–∏–Ω–≥–∞
sudo iptables -L FORWARD -n --line-numbers

# –ü—Ä–æ–≤–µ—Ä–∫–∞ IP forwarding
cat /proc/sys/net/ipv4/ip_forward
```

### –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞:

```bash
# –£–¥–∞–ª–µ–Ω–∏–µ PREROUTING –ø—Ä–∞–≤–∏–ª–∞ (–∑–∞–º–µ–Ω–∏—Ç–µ –Ω–æ–º–µ—Ä –ø—Ä–∞–≤–∏–ª–∞)
sudo iptables -t nat -D PREROUTING [–Ω–æ–º–µ—Ä]

# –£–¥–∞–ª–µ–Ω–∏–µ POSTROUTING –ø—Ä–∞–≤–∏–ª–∞
sudo iptables -t nat -D POSTROUTING [–Ω–æ–º–µ—Ä]

# –£–¥–∞–ª–µ–Ω–∏–µ FORWARD –ø—Ä–∞–≤–∏–ª
sudo iptables -D FORWARD [–Ω–æ–º–µ—Ä]
```

## üìù –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É

### –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ
- 1 CPU
- 512 MB RAM
- 5 GB –¥–∏—Å–∫

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ
- 1 CPU
- 1 GB RAM
- 10 GB –¥–∏—Å–∫
- –ù–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π —Ç—Ä–∞—Ñ–∏–∫

## üåê –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

- Ubuntu 18.04+
- Debian 9+
- CentOS 7+ (—Ç—Ä–µ–±—É–µ—Ç—Å—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è –¥–ª—è yum)
- –õ—é–±–æ–π Linux —Å iptables –∏ systemd

## ü§ù –í–∫–ª–∞–¥ –≤ –ø—Ä–æ–µ–∫—Ç

–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é—Ç—Å—è Pull Requests! –î–ª—è –∫—Ä—É–ø–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–π—Ç–µ Issue.

## üìú –õ–∏—Ü–µ–Ω–∑–∏—è

[MIT](LICENSE) ¬© 2024

## üôè –ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏

- CloudFlare –∑–∞ WARP —Å–µ—Ä–≤–∏—Å
- –°–æ–æ–±—â–µ—Å—Ç–≤—É WireGuard –∑–∞ –æ—Ç–ª–∏—á–Ω—ã–π VPN –ø—Ä–æ—Ç–æ–∫–æ–ª